<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <title>Introducing xsssniper - Tonic Vermifuge</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" />
    <!--<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css" rel="stylesheet" />-->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="http://brindi.si/g/theme/style.css" rel="stylesheet" />
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="http://brindi.si/g/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Tonic Vermifuge Full Atom Feed" />
    <link href="http://brindi.si/g/feeds/blog.atom.xml" type="application/atom+xml" rel="alternate" title="Tonic Vermifuge Categories Atom Feed" />
  </head>
  <body id="index" class="archive">
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <nav id="main-navbar" class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://brindi.si/g">Tonic Vermifuge</a>
        </div>
        <div class="collapse navbar-collapse navbar-right">
          <ul class="nav navbar-nav">
            <li><a href="http://brindi.si/g/pages/about.html">About</a></li>
            <li><a href="http://brindi.si/g/projects/">Projects</a></li>
          </ul>
        </div>
        <!-- /.navbar-collapse -->
      </div>
    </nav>
    <div class="container">
    <section id="content" class="article content">
      <header>
        <h2 class="entry-title">
          Introducing xsssniper
        </h2>
        
        <div class="text-muted">2011/09/16</div>
      </header>
<!-- .entry-content -->
      <div class="entry-content">
        <p>I wrote a little app called <em>xsssniper</em> to automatically test XSS injection
points in target URLs.</p>
<div class="highlight"><pre><span class="nv">$ </span>python xsssniper.py --url <span class="s1">&#39;X&#39;</span> --payload <span class="s1">&#39;Y&#39;</span> --check <span class="s1">&#39;Z&#39;</span>
</pre></div>


<p>What it does is scanning target URL for GET parameters and then inject an
XSS payload (Y) into them and parse the response for artefacts of the
injection (Z).</p>
<p>The simplest example would be to inject
<code>&lt;script type="text/javascript"&gt;window.alert('lol')&lt;/script&gt;</code> and check for
<code>&lt;script type="text/javascript"&gt;window.alert('lol')&lt;/script&gt;</code>, if we have a match maybe we have
just found an XSS.</p>
<p>If no check is specified xssniper will consider payload and check the same.</p>
<p>If no payload is specified as well a special file will be parsed for common
payloads (<code>lib/payloads.xml</code>, feel free to contribute!).</p>
<p>Another useful feature is the ability to crawl the target URL for relative
links. Every link found is added to the scan queue and processed, so it's
easier to test an entire website.</p>
<p>In the end this method is not fool proof but it's a good heuristic to mass
find injection points and test escape strategies. Also since there is no
browser emulation is your duty to manual test discovered injections against
various browser's xss protections.</p>
<p>Here is the usage:</p>
<div class="highlight"><pre>Usage: xsssniper.py <span class="o">[</span>options<span class="o">]</span>

Options:
  -h, --help            show this <span class="nb">help </span>message and <span class="nb">exit</span>
  -u URL, --url<span class="o">=</span>URL     target URL
  -p PAYLOAD, --payload<span class="o">=</span>PAYLOAD
                        payload to inject. If the payload is not
                        specified standard payloads from lib/payloads.xml
                        will be used
  -c CHECK, --check<span class="o">=</span>CHECK
                        payload artefact to search in response
  --threads<span class="o">=</span>THREADS     number of threads
  --http-proxy<span class="o">=</span>HTTP_PROXY
                        scan behind given proxy <span class="o">(</span>format: 127.0.0.1:80<span class="o">)</span>
  --tor                 scan behind default Tor
  --crawl               crawl target url <span class="k">for</span> other links to <span class="nb">test</span>
</pre></div>


<p>It's development is still active and I am adding features day after day.</p>
<p>For any suggestion feel free to contact me (mail or <a href="http://twitter.com/gbrindisi">twitter</a>) meanwhile
check out the <a href="http://bitbucket.org/gbrindisi/xsssniper">repository</a>.</p>
      </div>
<!-- /.entry-content -->
      <footer class="post-info text-muted">      
          <a href="http://brindi.si/g/category/blog.html" class="btn btn-default"><div class="fa fa-lg fa-folder-open"></div> blog</a>
      </footer>
      <!-- /.post-info -->
    <!-- Twitter BEGIN -->
    <div id="twitter">Follow me: <a href="https://twitter.com/gbrindisi">@gbrindisi</div>
    <!-- Twitter END -->
    </section>
    </div>
    <footer class="footer">
      <div class="container">
        <p class="footer-text"><!--<img style="height:50px" src="http://brindi.si/static/drug.png">--> &copy; <a href="http://brindi.si/g">Tonic Vermifuge</a> powered by coffee</p>
      </div>
    </footer>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-23969560-3', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>